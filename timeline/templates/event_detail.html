{% extends 'base.html' %}

{% load static %}


<!doctype html>

<html lang="en">
    
    {% include 'navbar.html' %}
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
        {% block meta %}
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <title>Timeline</title>
        <script>
            $(document).ready(function(){  
                $(`.button`).click(function () {
                    var info = $('.button').attr('id');
                    var dataSimpan;
                    let ada = null;
                    $.get("/timeline/json/", function(data){
                        for (i = 0; i < data.length; i++){
                            if (data[i].fields.namaEvent == info){
                                ada = true;
                                break;
                            }
                            ada = false;
                        }
                        if (ada === true) {
                            alert("Event sudah diikuti")
                        } else {
                            $.get("/create-event/json/", function(data){
                                for (i = 0; i < data.length; i++){
                                    if (data[i].fields.namaEvent == info){
                                        dataSimpan = data[i];
                                        break;
                                    }
                                }
                                $.post("/timeline/joinevent/",
                                {
                                    namaEvent : dataSimpan.fields.namaEvent,
                                    namaPantai: dataSimpan.fields.namaPantai,
                                    alamatPantai: dataSimpan.fields.alamatPantai,
                                    jumlahPartisipan: dataSimpan.fields.jumlahPartisipan,
                                    fotoPantai: dataSimpan.fields.fotoPantai,
                                    deskripsi: dataSimpan.fields.deskripsi,
                                    tanggalMulai: dataSimpan.fields.tanggalMulai,
                                    tanggalAkhir: dataSimpan.fields.tanggalAkhir,
                                },
                                function (data,status){
                                    alert("Event berhasil diikuti");
                                }
                            )
                            })
                        }
                    })
                    })
            })
            
        </script>
        {% endblock meta %}
    </head>

    <body>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        {% block content %}

        <style>
            .card-img-top {
            width: 100%;
            height: 40vw;
            object-fit: cover;
            object-position: center;
          }
          .card{
        
            border-radius: 15px;
            background: rgb(255, 255, 255);
            box-shadow: 0 6px 10px rgba(0,0,0,.08), 0 0 6px rgba(0,0,0,.05);
            transition: .3s ;
            
            cursor: pointer;
            margin-left: 10px;
            margin-right: 50px;
          }
        
          

          .card-title{
              font-size: 200%;
          }
        
          .blmada{
            font-style: italic;
            text-align: center;
          }
        
        </style>

        <button>
            <a href="/timeline/">Back</a>
        </button>
        <br>

        <div class="container">
        <div class="row row-cols-1 row-cols-md-1 g-4 mx-5">
            <div class ="card ratio-4x3" id="{{data.pk}}-card">
                <div class="card-header overflow-hidden p-0">
        
                <img class="w-40 h-30 card-img-top" src={{data.fotoPantai}} id="{{data.pk}}-foto">
              
                </div>
                
                <div class="card-body">
                
      
                <h5 class="card-title" id= "{{data.pk}}-namaEvent">{{data.namaEvent}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-namaPantai">{{data.namaPantai}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-alamatPantai">{{data.alamatPantai}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-jumlahPartisipan">{{data.jumlahPartisipan}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-deskripsi">{{data.deskripsi}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-tanggalMulai">{{data.tanggalMulai}}</h5>
                <h5 class="card-title" id= "{{data.pk}}-tanggalAkhir">{{data.fields.tanggalAkhir}}</h5>
      
                
                <button class="button" id="{{data.namaEvent}}">Join</button>
                
                </div>
            </div>
        </div>
        </div>
        <br>

        {% endblock content %}
    </body>

    {% include 'footer.html' %}

</html>